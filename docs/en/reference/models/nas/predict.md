---
description: Learn about NASPredictor in Ultralytics YOLO for efficient object detection. Explore its attributes, methods, and usage with examples.
keywords: Ultralytics, YOLO, NASPredictor, object detection, machine learning, AI, non-maximum suppression, bounding boxes, image processing
---

# Reference for `ultralytics/models/nas/predict.py`

!!! success "Improvements"

    This page is sourced from [https://github.com/ultralytics/ultralytics/blob/main/ultralytics/models/nas/predict.py](https://github.com/ultralytics/ultralytics/blob/main/ultralytics/models/nas/predict.py). Have an improvement or example to add? Open a [Pull Request](https://docs.ultralytics.com/help/contributing/) ‚Äî thank you! üôè

<br>

!!! abstract "Summary"

    === "<span class="doc-kind doc-kind-class">Classes</span>"

        - [`NASPredictor`](#ultralytics.models.nas.predict.NASPredictor)

    === "<span class="doc-kind doc-kind-method">Methods</span>"

        - [`NASPredictor.postprocess`](#ultralytics.models.nas.predict.NASPredictor.postprocess)


## Class `ultralytics.models.nas.predict.NASPredictor` {#ultralytics.models.nas.predict.NASPredictor}

```python
NASPredictor()
```

**Bases:** `DetectionPredictor`

Ultralytics YOLO NAS Predictor for object detection.

This class extends the DetectionPredictor from Ultralytics engine and is responsible for post-processing the raw predictions generated by the YOLO NAS models. It applies operations like non-maximum suppression and scaling the bounding boxes to fit the original image dimensions.

**Attributes**

| Name | Type | Description |
| --- | --- | --- |
| `args` | `Namespace` | Namespace containing various configurations for post-processing including confidence<br>    threshold, IoU threshold, agnostic NMS flag, maximum detections, and class filtering options. |
| `model` | `torch.nn.Module` | The YOLO NAS model used for inference. |
| `batch` | `list` | Batch of inputs for processing. |

**Methods**

| Name | Description |
| --- | --- |
| [`postprocess`](#ultralytics.models.nas.predict.NASPredictor.postprocess) | Postprocess NAS model predictions to generate final detection results. |

**Examples**

```python
>>> from ultralytics import NAS
>>> model = NAS("yolo_nas_s")
>>> predictor = model.predictor

Assume that raw_preds, img, orig_imgs are available
>>> results = predictor.postprocess(raw_preds, img, orig_imgs)
```

!!! note "Notes"

    Typically, this class is not instantiated directly. It is used internally within the NAS class.

<details>
<summary>Source code in <code>ultralytics/models/nas/predict.py</code></summary>

<a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/models/nas/predict.py#L9-L56"><i class="fa-brands fa-github" aria-hidden="true" style="margin-right:6px;"></i>View on GitHub</a>
```python
class NASPredictor(DetectionPredictor):
```
</details>

<br>

### Method `ultralytics.models.nas.predict.NASPredictor.postprocess` {#ultralytics.models.nas.predict.NASPredictor.postprocess}

```python
def postprocess(self, preds_in, img, orig_imgs)
```

Postprocess NAS model predictions to generate final detection results.

This method takes raw predictions from a YOLO NAS model, converts bounding box formats, and applies post-processing operations to generate the final detection results compatible with Ultralytics result visualization and analysis tools.

**Args**

| Name | Type | Description | Default |
| --- | --- | --- | --- |
| `preds_in` | `list` | Raw predictions from the NAS model, typically containing bounding boxes and class scores. | *required* |
| `img` | `torch.Tensor` | Input image tensor that was fed to the model, with shape (B, C, H, W). | *required* |
| `orig_imgs` | `list | torch.Tensor | np.ndarray` | Original images before preprocessing, used for scaling<br>    coordinates back to original dimensions. | *required* |

**Returns**

| Type | Description |
| --- | --- |
| `list` | List of Results objects containing the processed predictions for each image in the batch. |

**Examples**

```python
>>> predictor = NAS("yolo_nas_s").predictor
>>> results = predictor.postprocess(raw_preds, img, orig_imgs)
```

<details>
<summary>Source code in <code>ultralytics/models/nas/predict.py</code></summary>

<a href="https://github.com/ultralytics/ultralytics/blob/main/ultralytics/models/nas/predict.py#L34-L56"><i class="fa-brands fa-github" aria-hidden="true" style="margin-right:6px;"></i>View on GitHub</a>
```python
def postprocess(self, preds_in, img, orig_imgs):
    """Postprocess NAS model predictions to generate final detection results.

    This method takes raw predictions from a YOLO NAS model, converts bounding box formats, and applies
    post-processing operations to generate the final detection results compatible with Ultralytics result
    visualization and analysis tools.

    Args:
        preds_in (list): Raw predictions from the NAS model, typically containing bounding boxes and class scores.
        img (torch.Tensor): Input image tensor that was fed to the model, with shape (B, C, H, W).
        orig_imgs (list | torch.Tensor | np.ndarray): Original images before preprocessing, used for scaling
            coordinates back to original dimensions.

    Returns:
        (list): List of Results objects containing the processed predictions for each image in the batch.

    Examples:
        >>> predictor = NAS("yolo_nas_s").predictor
        >>> results = predictor.postprocess(raw_preds, img, orig_imgs)
    """
    boxes = ops.xyxy2xywh(preds_in[0][0])  # Convert bounding boxes from xyxy to xywh format
    preds = torch.cat((boxes, preds_in[0][1]), -1).permute(0, 2, 1)  # Concatenate boxes with class scores
    return super().postprocess(preds, img, orig_imgs)
```
</details>

<br><br>
